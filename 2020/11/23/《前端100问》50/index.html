

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;light&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#07689f">
  <meta name="description" content="">
  <meta name="author" content="playlife">
  <meta name="keywords" content="">
  <title>《前端100问》50 - playlife</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_2101544_ifd43zekazn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 80vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>playlife</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-zhuye"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-guidangxiangmu"></i>
                Archive
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-label_icon"></i>
                Tag
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-github3"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/post_page.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-11-23 08:43" pubdate>
        2020-11-23rd 08:43:03 AM
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      43
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">《前端100问》50</h1>
            
            <div class="markdown-body" id="post-body">
              <h1 id="41、下面代码输出什么"><a href="#41、下面代码输出什么" class="headerlink" title="41、下面代码输出什么"></a>41、下面代码输出什么</h1><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-built_in">console</span>.log(a)<span class="hljs-comment">//undefined</span>
    a = <span class="hljs-number">5</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">window</span>.a)<span class="hljs-comment">//10</span>
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">20</span>;
    <span class="hljs-built_in">console</span>.log(a)<span class="hljs-comment">//20</span>
&#125;)()</code></pre>

<p>分别为 <code>undefined</code>　<code>10</code>　<code>20</code>，原因是作用域问题</p>
<p>在内部声名<code>var a = 20</code>；相当于先声明 <code>var a </code>然后再执行赋值操作，这是在 <strong>IIFE</strong> 内形成的独立作用域。</p>
<p>如果把 <code>var a=20</code>注释掉，那么 <code>a</code> 只有在外部有声明，显示的就是外部的 <code>a</code> 变量的值了。结果 <code>a</code> 会是 <code>10</code>　<code>5</code>　<code>5</code></p>
<h1 id="42、实现一个-sleep-函数"><a href="#42、实现一个-sleep-函数" class="headerlink" title="42、实现一个 sleep 函数"></a>42、实现一个 sleep 函数</h1><blockquote>
<p>比如 sleep(1000) 意味着等待1000毫秒，可从 Promise、Generator、Async/Await 等角度实现</p>
</blockquote>
<pre><code class="hljs js"><span class="hljs-comment">// Promise 实现</span>
<span class="hljs-keyword">const</span> sleep = <span class="hljs-function"><span class="hljs-params">time</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time))

sleep(<span class="hljs-number">1000</span>).then(<span class="hljs-function">() =&gt;</span> &#123;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)
&#125;)

<span class="hljs-comment">// Generator</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">sleepGenerator</span>(<span class="hljs-params">time</span>) </span>&#123;
  <span class="hljs-keyword">yield</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time))
&#125;
<span class="hljs-comment">//next() 返回一个由 yield表达式生成的值。，value拿到返回值</span>
sleepGenerator(<span class="hljs-number">1000</span>)
  .next()
  .value.then(<span class="hljs-function">() =&gt;</span> &#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)
  &#125;)

<span class="hljs-comment">//async</span>
<span class="hljs-keyword">const</span> sleep = <span class="hljs-function"><span class="hljs-params">time</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time))
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"></span>) </span>&#123;
  <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">1000</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)
&#125;
output()

<span class="hljs-comment">// ES5 回调函数</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">callback, time</span>) </span>&#123;
  <span class="hljs-built_in">setTimeout</span>(callback, time)
&#125;
sleep(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"></span>) </span>&#123;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)
&#125;, <span class="hljs-number">1000</span>)</code></pre>





<h1 id="43、使用-sort-进行排序，输出结果"><a href="#43、使用-sort-进行排序，输出结果" class="headerlink" title="43、使用 sort() 进行排序，输出结果"></a>43、使用 sort() 进行排序，输出结果</h1><blockquote>
<p>使用 sort() 对数组 [3, 15, 8, 29, 102, 22] 进行排序，输出结果</p>
</blockquote>
<pre><code class="hljs js">[<span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">29</span>, <span class="hljs-number">102</span>, <span class="hljs-number">22</span>].sort() <span class="hljs-comment">// [ 102, 15, 22, 29, 3, 8 ]</span></code></pre>

<p>根据MDN上对<code>Array.sort()</code>的解释，默认的排序方法会将数组元素转换为字符串，然后比较字符串中字符的UTF-16编码顺序来进行排序。所以<code>&#39;102&#39;</code> 会排在 <code>&#39;15&#39;</code> 前面。</p>
<p><strong>Array.prototype.sort()</strong></p>
<blockquote>
<p><code>sort()</code> 方法用原地算法对数组的元素进行排序，并返回数组。默认排序顺序是在将元素转换为字符串，然后比较它们的UTF-16代码单元值序列时构建的</p>
</blockquote>
<p>返回值:</p>
<p>排序后的数组。请注意，数组已原地排序，并且不进行复制。</p>
<pre><code class="hljs js">[<span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">29</span>, <span class="hljs-number">102</span>, <span class="hljs-number">22</span>].sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>) </span>&#123;
<span class="hljs-keyword">return</span> a-b;
&#125;)
<span class="hljs-comment">//输出： [3, 8, 15, 22, 29, 102]</span></code></pre>





<h1 id="44、介绍-HTTPS-握手过程"><a href="#44、介绍-HTTPS-握手过程" class="headerlink" title="44、介绍 HTTPS 握手过程"></a>44、介绍 HTTPS 握手过程</h1><h2 id="一、Client-→-Server"><a href="#一、Client-→-Server" class="headerlink" title="一、Client → Server"></a>一、Client → Server</h2><h3 id="Client-Hello"><a href="#Client-Hello" class="headerlink" title="Client Hello"></a>Client Hello</h3><p>握手开始时，总是由先客户端会发送 <code>Client Hello</code> 信息给服务端，主要包含</p>
<ul>
<li>Version Number 客户端支持的协议版本</li>
<li>Randomly Generated Data 32 字节长度的随机值，用于之后生成主密钥。</li>
<li>Session Identification Session ID，第一次连接时为空。</li>
<li>Cipher Suite 客户端支持的加密算法列表，按优先级顺序排列。</li>
</ul>
<h2 id="二、Server-→-Client"><a href="#二、Server-→-Client" class="headerlink" title="二、Server → Client"></a>二、Server → Client</h2><h3 id="Server-Hello"><a href="#Server-Hello" class="headerlink" title="Server Hello"></a>Server Hello</h3><p>接着，服务端收到客户端发来的消息之后，会返回 <code>Server Hello</code> 信息给客户端，告知客户端接下来使用的一些参数</p>
<ul>
<li>Version Number 通信协议版本</li>
<li>Randomly Generated Data 32 字节长度的随机值，用于之后生成主密钥</li>
<li>Session Identification Session ID</li>
<li>Cipher Suite 加密算法</li>
</ul>
<h3 id="Server-Certificate-证书"><a href="#Server-Certificate-证书" class="headerlink" title="Server Certificate 证书"></a>Server Certificate 证书</h3><p>服务端还会带上证书返回给客户端。证书中含有服务端的公钥、网站地址、证书的颁发机构等信息。</p>
<p>客户端收到服务端返回的证书之后，会验证该证书的真实合法性。</p>
<h3 id="Server-Key-Exchange-额外数据"><a href="#Server-Key-Exchange-额外数据" class="headerlink" title="Server Key Exchange 额外数据"></a>Server Key Exchange 额外数据</h3><p>这个是可选的，取决于使用的加密算法。主要是携带密钥交换的额外数据。</p>
<h3 id="Server-Hello-Done"><a href="#Server-Hello-Done" class="headerlink" title="Server Hello Done"></a>Server Hello Done</h3><p>表示服务端已经发送完毕，并等待客户端回应。</p>
<h2 id="三、Client-→-Server"><a href="#三、Client-→-Server" class="headerlink" title="三、Client → Server"></a>三、Client → Server</h2><h3 id="Client-Key-Exchange"><a href="#Client-Key-Exchange" class="headerlink" title="Client Key Exchange"></a>Client Key Exchange</h3><p>客户端使用之前发送给服务端及服务端返回的随机数，生成预主密钥，然后用服务端返回的公钥进行加密。</p>
<h3 id="Change-Cipher-Spec"><a href="#Change-Cipher-Spec" class="headerlink" title="Change Cipher Spec"></a>Change Cipher Spec</h3><p>告诉服务端，之后的所有信息都会使用协商好的密钥和算法加密</p>
<h3 id="Client-Finished"><a href="#Client-Finished" class="headerlink" title="Client Finished"></a>Client Finished</h3><p>客户端的握手工作已经完成。这条信息是握手过程中所有消息的散列值。</p>
<h2 id="四、Server-→-Client"><a href="#四、Server-→-Client" class="headerlink" title="四、Server → Client"></a>四、Server → Client</h2><h3 id="Change-Cipher-Spec-Message"><a href="#Change-Cipher-Spec-Message" class="headerlink" title="Change Cipher Spec Message"></a>Change Cipher Spec Message</h3><p>告知客户端，会使用刚刚协商的密钥来加密信息</p>
<h3 id="Server-Finished-Message"><a href="#Server-Finished-Message" class="headerlink" title="Server Finished Message"></a>Server Finished Message</h3><p>表示服务端的握手工作已经完成</p>
<h2 id="数字证书申请流程"><a href="#数字证书申请流程" class="headerlink" title="数字证书申请流程"></a>数字证书申请流程</h2><ol>
<li>网站提交身份信息给CA机构</li>
<li>CA机构审核信息的真实性</li>
<li>对信息进行Hash，计算信息摘要</li>
<li>CA机构的密钥加密信息摘要，得到数字签名</li>
</ol>
<h2 id="浏览器验证证书"><a href="#浏览器验证证书" class="headerlink" title="浏览器验证证书"></a>浏览器验证证书</h2><ol>
<li>浏览器利用证书的原始信息计算得到信息摘要</li>
<li>利用CA的公钥解密数字证书中的数字签名，解密出来的数据也是信息摘要</li>
<li>比较两个摘要是否相等</li>
</ol>
<h1 id="45、HTTPS-握手过程中，客户端如何验证证书的合法性"><a href="#45、HTTPS-握手过程中，客户端如何验证证书的合法性" class="headerlink" title="45、HTTPS 握手过程中，客户端如何验证证书的合法性"></a>45、HTTPS 握手过程中，客户端如何验证证书的合法性</h1><ol>
<li><p>首先浏览器读取证书中的证书所有者、有效期等信息进行校验，校验证书的网站域名是否与证书颁发的域名一致，校验证书是否在有效期内</p>
</li>
<li><p>浏览器开始查找操作系统中已内置的受信任的证书发布机构CA，与服务器发来的证书中的颁发者CA比对，用于校验证书是否为合法机构颁发</p>
</li>
<li><p>两种情况：</p>
<ol>
<li><p>如果找不到，浏览器就会报错，说明服务器发来的证书是不可信任的。</p>
</li>
<li><p>如果找到，那么浏览器就会从操作系统中取出颁发者CA 的公钥(多数浏览器开发商发布<br>版本时，会事先在内部植入常用认证机关的公开密钥)，然后对服务器发来的证书里面的签名进行解密</p>
</li>
</ol>
</li>
<li><p>浏览器使用相同的hash算法计算出服务器发来的证书的hash值，将这个计算的hash值与证书中签名做对比</p>
</li>
<li><p>对比结果一致，则证明服务器发来的证书合法，没有被冒充</p>
</li>
</ol>
<h1 id="46、输出以下代码执行的结果并解释为什么"><a href="#46、输出以下代码执行的结果并解释为什么" class="headerlink" title="46、输出以下代码执行的结果并解释为什么"></a>46、输出以下代码执行的结果并解释为什么</h1><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = &#123;
    <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-number">3</span>,
    <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-number">4</span>,
    <span class="hljs-string">&#x27;length&#x27;</span>: <span class="hljs-number">2</span>,
    <span class="hljs-string">&#x27;splice&#x27;</span>: <span class="hljs-built_in">Array</span>.prototype.splice,
    <span class="hljs-string">&#x27;push&#x27;</span>: <span class="hljs-built_in">Array</span>.prototype.push
&#125;
obj.push(<span class="hljs-number">1</span>)
obj.push(<span class="hljs-number">2</span>)
<span class="hljs-built_in">console</span>.log(obj)</code></pre>

<p>MDN描述：</p>
<blockquote>
<p>push方法将值追加到数组中。</p>
</blockquote>
<p><code>push</code> 方法具有通用性。该方法和 <code>call()</code> 或 <code>apply()</code> 一起使用时，可应用在类似数组的对象上。</p>
<p><code>push</code> 方法根据 <code>length</code> 属性来决定从哪里开始插入给定的值。</p>
<p>如果 <code>length</code> 不能被转成一个数值，则插入的元素索引为 0，包括 <code>length</code> 不存在时。</p>
<p>当 <code>length</code> 不存在时，将会创建它。</p>
<pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = &#123;
    <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-number">3</span>,
    <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-number">4</span>,
    <span class="hljs-string">&#x27;length&#x27;</span>: <span class="hljs-number">2</span>,    
    <span class="hljs-string">&#x27;push&#x27;</span>: <span class="hljs-built_in">Array</span>.prototype.push
&#125;
obj.push(<span class="hljs-number">1</span>)
obj.push(<span class="hljs-number">2</span>)
<span class="hljs-built_in">console</span>.log(obj)
<span class="hljs-comment">//打印： &#123;2: 1, 3: 2, length: 4, push: ƒ&#125;</span>
<span class="hljs-keyword">var</span> obj1 = &#123;
    <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-number">3</span>,
    <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-number">4</span>,
    <span class="hljs-string">&#x27;length&#x27;</span>: <span class="hljs-number">2</span>,
    <span class="hljs-string">&#x27;splice&#x27;</span>: <span class="hljs-built_in">Array</span>.prototype.splice,
    <span class="hljs-string">&#x27;push&#x27;</span>: <span class="hljs-built_in">Array</span>.prototype.push
&#125;
obj1.push(<span class="hljs-number">1</span>)
obj1.push(<span class="hljs-number">2</span>)
<span class="hljs-built_in">console</span>.log(obj1)
<span class="hljs-comment">//Object(4) [empty × 2, 1, 2, splice: ƒ, push: ƒ]</span>

<span class="hljs-keyword">var</span> obj2 = &#123;
  <span class="hljs-number">2</span>: <span class="hljs-number">3</span>,
  <span class="hljs-number">3</span>: <span class="hljs-number">4</span>,
  push: <span class="hljs-built_in">Array</span>.prototype.push
&#125;
obj2.push(<span class="hljs-number">1</span>)
obj2.push(<span class="hljs-number">2</span>)
<span class="hljs-built_in">console</span>.log(obj2)
<span class="hljs-comment">// &#123;0: 1, 1: 2, 2: 3, 3: 4, length: 2, push: ƒ&#125;</span></code></pre>

<p>解释：</p>
<p><code>push</code> 方法具有通用性，所以可以给类数组使用。具体是根据类数组的 <code>length</code> 属性，将其转换为数值当做<code>对象[数值]</code>来使用，而对象使用<code>对象[数值]</code>时，数值一律当成字符处理也是就是<code>obj[1]</code>和 <code>obj[&#39;1&#39;]</code>是等价的。</p>
<p>所以<code>push</code>会解析 <code>length</code>的值 往<code>obj[2]</code> push 一个 <code>1</code> ，所以<code>obj</code> 的属性 <code>2</code> 的值会变成 <code>1</code>，此时 <code>obj</code> 并没有数组的独有方法，所以JS解析器还是会打印一个对象。</p>
<p>而<code>obj1</code>有一个只有数组的才有的 <code>splice</code> 方法，而且 <code>length</code> 为 <code>4</code> 所以 JS解析器会将其当成数组来打印输出，从下标<code>0</code>开始读数据，但是并没有数据会补空最后输出。</p>
<h1 id="47、双向绑定和-vuex-是否冲突"><a href="#47、双向绑定和-vuex-是否冲突" class="headerlink" title="47、双向绑定和 vuex 是否冲突"></a>47、双向绑定和 vuex 是否冲突</h1><p>在严格模式下直接使用确实会有问题。</p>
<p>在严格模式中使用Vuex，当用户输入时，v-model 会试图直接修改属性值，但这个修改不是在 mutation中修改的，所以会抛出一个错误。</p>
<p>处理方法：</p>
<blockquote>
<p>来自官网文档：</p>
</blockquote>
<p>当在严格模式中使用 Vuex 时，在属于 Vuex 的 state 上使用 <code>v-model</code> 会比较棘手：</p>
<pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;obj.message&quot;</span>&gt;</span></code></pre>

<p>假设这里的 <code>obj</code> 是在计算属性中返回的一个属于 Vuex store 的对象，在用户输入时，<code>v-model</code> 会试图直接修改 <code>obj.message</code>。在严格模式中，由于这个修改不是在 mutation 函数中执行的, 这里会抛出一个错误。</p>
<p>方法一：不用<code>v-model</code> 直接绑定<code>value</code>值和监听<code>input</code>事件</p>
<p>用“Vuex 的思维”去解决这个问题的方法是：给 <code>&lt;input&gt;</code> 中绑定 value，然后侦听 <code>input</code> 或者 <code>change</code> 事件，在事件回调中调用一个方法:</p>
<pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;message&quot;</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;updateMessage&quot;</span>&gt;</span></code></pre>

<pre><code class="hljs js"><span class="hljs-comment">// ...</span>
computed: &#123;
  ...mapState(&#123;
    message: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.obj.message
  &#125;)
&#125;,
methods: &#123;
  updateMessage (e) &#123;
    <span class="hljs-built_in">this</span>.$store.commit(<span class="hljs-string">&#x27;updateMessage&#x27;</span>, e.target.value)
  &#125;
&#125;</code></pre>

<p>下面是 mutation 函数：</p>
<pre><code class="hljs js"><span class="hljs-comment">// ...</span>
mutations: &#123;
  updateMessage (state, message) &#123;
    state.obj.message = message
  &#125;
&#125;</code></pre>

<p>方法二：双向绑定的计算属性 给计算属性设置<code>getter</code>和<code>setter</code></p>
<p>必须承认，这样做比简单地使用“<code>v-model</code> + 局部状态”要啰嗦得多，并且也损失了一些 <code>v-model</code> 中很有用的特性。另一个方法是使用带有 setter 的双向绑定计算属性：</p>
<pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;message&quot;</span>&gt;</span></code></pre>

<pre><code class="hljs js"><span class="hljs-comment">// ...</span>
computed: &#123;
  message: &#123;
    get () &#123;
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.$store.state.obj.message <span class="hljs-comment">//读 Vuex 数据</span>
    &#125;,
    set (value) &#123;
      <span class="hljs-built_in">this</span>.$store.commit(<span class="hljs-string">&#x27;updateMessage&#x27;</span>, value)<span class="hljs-comment">//提交 mutation 更改 Vuex 数据</span>
    &#125;
  &#125;
&#125;</code></pre>





<h1 id="48、call-和-apply-的区别是什么，哪个性能更好一些"><a href="#48、call-和-apply-的区别是什么，哪个性能更好一些" class="headerlink" title="48、call 和 apply 的区别是什么，哪个性能更好一些"></a>48、call 和 apply 的区别是什么，哪个性能更好一些</h1><ol>
<li><code>Function.prototype.apply</code> 和 <code>Function.prototype.call</code> 的作用是一样的，区别在于传入参数的不同；</li>
<li>第一个参数都是，指定函数体内 <code>this</code> 的指向；</li>
<li>第二个参数开始不同，<code>apply</code> 是传入带下标的<strong>集合</strong>，<strong>数组</strong>或者<strong>类数组</strong>，<code>apply</code>把它传给函数作为参数，<code>call</code>从第二个开始传入的参数是不固定的，都会传给函数作为参数。</li>
<li>call比apply的性能要好，平常可以多用call, call传入参数的格式正是内部所需要的格式。</li>
</ol>
<h1 id="49、为什么通常在发送数据埋点请求的时候使用的是-1x1-像素的透明-gif-图片？"><a href="#49、为什么通常在发送数据埋点请求的时候使用的是-1x1-像素的透明-gif-图片？" class="headerlink" title="49、为什么通常在发送数据埋点请求的时候使用的是 1x1 像素的透明 gif 图片？"></a>49、为什么通常在发送数据埋点请求的时候使用的是 1x1 像素的透明 gif 图片？</h1><p><strong>前端监控的原理</strong></p>
<p>所谓的前端监控，其实是在满足一定条件后，由Web页面将用户信息（UA/鼠标点击位置/页面报错/停留时长/etc）上报给服务器的过程。一般是将上报数据用url_encode（百度统计/CNZZ）或JSON编码（神策/诸葛io）为字符串，通过url参数传递给服务器，然后在服务器端统一处理。</p>
<p>这套流程的关键在于：</p>
<p>1）能够收集到用户信息；</p>
<p>2）能够将收集到的数据上报给服务器。也就是说，只要能上报数据，无论是请求GIF文件还是请求js文件或者是调用页面接口，服务器端其实并不关心具体的上报方式。</p>
<p>首先，为什么不能直接用GET/POST/HEAD请求接口进行上报？</p>
<blockquote>
<p>一般而言，打点域名都不是当前域名，所以所有的接口请求都会构成跨域。而跨域请求很容易出现由于配置不当被浏览器拦截并报错，这是不能接受的。所以，直接排除。</p>
</blockquote>
<p>为什么不能用请求其他的文件资源（js/css/ttf）的方式进行上报？</p>
<blockquote>
<p>这和浏览器的特性有关。通常，创建资源节点后只有将对象注入到浏览器DOM树后，浏览器才会实际发送资源请求。反复操作DOM不仅会引发性能问题，而且载入js/css资源还会阻塞页面渲染，影响用户体验。</p>
<p>但是图片请求例外。构造图片打点不仅不用插入DOM，只要在 JS 中 new 出 Image 对象就能发起请求，而且还没有阻塞问题，在没有 JS 的浏览器环境中也能通过 img标签正常打点，这是其他类型的资源请求所做不到的。</p>
</blockquote>
<p>同样都是图片，上报时选用了1x1的透明GIF，而不是其他的PNG/JEPG/BMP文件？</p>
<blockquote>
<p>首先，1x1像素是最小的合法图片。</p>
<p>而且，因为是通过图片打点，所以图片最好是透明的，这样一来不会影响页面本身展示效果，二者表示图片透明只要使用一个二进制位标记图片是透明色即可，不用存储色彩空间数据，可以节约体积。</p>
<p>因为需要透明色，所以可以直接排除JEPG(BMP32格式可以支持透明色)。</p>
<p>在体积方面最小的BMP文件需要74个字节，PNG需要67个字节，而合法的GIF，只需要43个字节。</p>
<p>同样的响应，GIF可以比BMP节约41%的流量，比PNG节约35%的流量。</p>
</blockquote>
<p>所以，总结：</p>
<p>前端监控使用GIF进行上报主要是因为：</p>
<ul>
<li>没有跨域问题；</li>
<li>能够完成整个 HTTP 请求+响应（尽管不需要响应内容）</li>
<li>触发 GET 请求之后不需要获取和处理数据、服务器也不需要发送数据</li>
<li>不会阻塞页面加载，影响用户体验</li>
<li>相比 XMLHttpRequest 对象发送 GET 请求，性能上更好</li>
<li>在所有图片中体积最小，相较BMP/PNG，可以节约41%/35%的网络资源。</li>
</ul>
<h1 id="50、实现-5-add-3-minus-2-功能。"><a href="#50、实现-5-add-3-minus-2-功能。" class="headerlink" title="50、实现 (5).add(3).minus(2) 功能。"></a>50、实现 (5).add(3).minus(2) 功能。</h1><p> JavaScript 的 <code>Number</code> 对象是经过封装的能让你处理数字值的对象。<code>Number</code> 对象由 <code>Number()</code> 构造器创建。</p>
<p><code>(5)</code> 和 <code>Number(5)</code>完全等价 </p>
<p><code>Number.isNaN()</code> 确定传递的值是否是 NaN。</p>
<p><code>Number.prototype.valueOf()</code>  <code>valueOf()</code> 方法返回一个被 <code>Number</code>对象包装的原始值。</p>
<pre><code class="hljs js"><span class="hljs-built_in">Number</span>.prototype.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) </span>&#123;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">&#x27;number&#x27;</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;请输入数字～&#x27;</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.valueOf() + n
&#125;
<span class="hljs-built_in">Number</span>.prototype.minus = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) </span>&#123;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">&#x27;number&#x27;</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;请输入数字～&#x27;</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.valueOf() - n
&#125;

<span class="hljs-built_in">console</span>.log((<span class="hljs-number">5</span>).add(<span class="hljs-number">3</span>).minus(<span class="hljs-number">2</span>))</code></pre>



<pre><code class="hljs js"><span class="hljs-built_in">Number</span>.prototype.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>&#123;
  <span class="hljs-keyword">let</span> number = <span class="hljs-built_in">parseFloat</span>(value)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> number !== <span class="hljs-string">&#x27;number&#x27;</span> || <span class="hljs-built_in">Number</span>.isNaN(number)) &#123;
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;请输入数字或者数字字符串～&#x27;</span>)
  &#125;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span> + number
&#125;
<span class="hljs-built_in">Number</span>.prototype.minus = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>&#123;
  <span class="hljs-keyword">let</span> number = <span class="hljs-built_in">parseFloat</span>(value)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> number !== <span class="hljs-string">&#x27;number&#x27;</span> || <span class="hljs-built_in">Number</span>.isNaN(number)) &#123;
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;请输入数字或者数字字符串～&#x27;</span>)
  &#125;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span> - number
&#125;
<span class="hljs-built_in">console</span>.log((<span class="hljs-number">5</span>).add(<span class="hljs-number">3</span>).minus(<span class="hljs-number">2</span>))
<span class="hljs-comment">//更加强壮，排除了NaN 兼容了字符串</span></code></pre>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E9%9D%A2%E8%AF%95/">面试</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-primary">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/11/30/Vue%20%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Vue 双向数据绑定</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/11/20/%E3%80%8A%E5%89%8D%E7%AB%AF100%E9%97%AE%E3%80%8B40/">
                        <span class="hidden-mobile">《前端100问》40</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <span>Power by</span>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"
        ><span>Hexo</span></a
      >
      <i class="iconfont icon-love"></i><span>Theme</span>
      <a
        href="https://github.com/fluid-dev/hexo-theme-fluid"
        target="_blank"
        rel="nofollow noopener"
      >
        <span>Fluid</span></a
      >
    </div>
    
 
 
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "《前端100问》50&nbsp;",
      ],
      cursorChar: "|",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
